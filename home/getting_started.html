<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Getting Started :: Stackable Documentation</title>
    <link rel="canonical" href="https://docs.stackable.tech/home/getting_started.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../_/css/site.css">
    <script>var uiRootPath = '../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.stackable.tech">Stackable Documentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="home" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Stackable Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="getting_started.html">Getting Started</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="supported-versions.html">Supported Product Versions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="monitoring.html">Monitoring</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Contributor&#8217;s Guide</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="contributor/contribution_guide.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="contributor/development_dashboard.html">Development Dashboard</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="contributor/new_product_version.html">New Product Version</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Architectural Decision Records</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Current</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#ADR001-choose_project_language.adoc">ADR001-choose_project_language.adoc</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#ADR002-choose_repository_structure.adoc">ADR002-choose_repository_structure.adoc</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#ADR003-choose_review_mechanism.adoc">ADR003-choose_review_mechanism.adoc</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#ADR004-choose_agent_programming_language.adoc">ADR004-choose_agent_programming_language.adoc</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#ADR005-systemd_unit_file_location.adoc">ADR005-systemd_unit_file_location.adoc</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#ADR007-defined_reuse_of_k8s.adoc">ADR007-defined_reuse_of_k8s.adoc</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#ADR008-decide_reuse_of_operators.adoc">ADR008-decide_reuse_of_operators.adoc</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#ADR009-selector_support.adoc">ADR009-selector_support.adoc</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#ADR010-command_pattern.adoc">ADR010-command_pattern.adoc</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#ADR011-directory_structure.adoc">ADR011-directory_structure.adoc</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#ADR012-authn_token_management.adoc">ADR012-authn_token_management.adoc</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Deprecated</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#deprecated/ADR006-choose_orchestrator_storage_backend.adoc">deprecated/ADR006-choose_orchestrator_storage_backend.adoc</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Drafts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#drafts/ADRx-choose_authorization_engine.adoc">drafts/ADRx-choose_authorization_engine.adoc</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Stackable Documentation</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="index.html">Stackable Documentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../airflow/index.html">Stackable Operator for Apache Airflow</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../airflow/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../druid/index.html">Stackable Operator for Apache Druid</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../druid/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../hbase/index.html">Stackable Operator for Apache HBase</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../hbase/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../hdfs/index.html">Stackable Operator for Apache HDFS</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../hdfs/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../hive/index.html">Stackable Operator for Apache Hive</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../hive/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../kafka/index.html">Stackable Operator for Apache Kafka</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../kafka/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../nifi/index.html">Stackable Operator for Apache NiFi</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../nifi/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../spark/index.html">Stackable Operator for Apache Spark</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../spark/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../superset/index.html">Stackable Operator for Apache Superset</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../superset/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../zookeeper/index.html">Stackable Operator for Apache ZooKeeper</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../zookeeper/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../opa/index.html">Stackable Operator for OpenPolicyAgent</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../opa/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../trino/index.html">Stackable Operator for Trino</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../trino/index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Stackable Documentation</a></li>
    <li><a href="getting_started.html">Getting Started</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/stackabletech/documentation/edit/main/modules/ROOT/pages/getting_started.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Getting Started</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>One of the best ways of getting started with a new platform is to try it out. Any big data platform has a lot of moving parts and getting some hands on keyboard time with it helps reinforce learning.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_about_this_guide"><a class="anchor" href="#_about_this_guide"></a>About this guide</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Firstly, let’s cover whether this <strong>Getting Started</strong> guide is right for you. This is intended as a learning tool to discover more about Stackable, its deployment and architecture.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you just want to get up and running quickly there is a quickstart script that will install services on a single node available in the <a href="https://github.com/stackabletech/stackable-utils">stackable-utils</a> repository on GitHub.</p>
</li>
<li>
<p>If you want to build a production cluster then this is not for you. This tutorial is to familiarise you with the Stackable architecture and is not a guide for building robust clusters.</p>
</li>
<li>
<p>This is intended for use in a private network or lab; it doesn&#8217;t enable many security features such as authentication or encryption and should not be directly connected to the Internet. Be careful if you&#8217;re deploying in the cloud as your instances may default to using public IPs.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stackable is based on Kubernetes and uses this as the control plane to manage clusters. In this guide we will build a simple cluster with 3 services; Apache ZooKeeper, Apache Kafka and Apache NiFi.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installing_kubernetes"><a class="anchor" href="#_installing_kubernetes"></a>Installing Kubernetes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stackable’s control plane is built around Kubernetes, and we&#8217;ll give some brief examples of how to install Kubernetes on your machine.</p>
</div>
<div class="sect2">
<h3 id="_installing_kubernetes_using_kind"><a class="anchor" href="#_installing_kubernetes_using_kind"></a>Installing Kubernetes using Kind</h3>
<div class="paragraph">
<p>Kind offers a very quick and easy way to bootstrap your Kubernetes infrastructure in Docker. The big advantage of this is that you can simply remove the Docker containers when you&#8217;re finished and clean up easily, making it great for testing and development.</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t already have Docker then visit <a href="https://docs.docker.com/get-docker/">Docker Website</a> to find out how to install Docker. Kind is a single executable that performs the tasks of installing and configuring Kubernetes for you within Docker containers. The <a href="https://kind.sigs.k8s.io/docs/user/quick-start/">Kind Website</a> has instructions for installing Kind on your system.</p>
</div>
<div class="paragraph">
<p>Once you have both of these installed then you can build a Kubernetes cluster in Docker. We&#8217;re going to create a 2 node cluster to test out Stackable, one node hosting the Kubernetes control plane and the other hosting the Stackable services.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>kind create cluster --name quickstart --config - &lt;&lt; EOF
---
kind: Cluster
apiVersion: kind.x-k8s.io/v1alpha4
nodes:
- role: control-plane
- role: worker
  kubeadmConfigPatches:
    - |
      kind: JoinConfiguration
      nodeRegistration:
        kubeletExtraArgs:
          node-labels: node=quickstart-1
EOF</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_installing_kubernetes_using_k3s"><a class="anchor" href="#_installing_kubernetes_using_k3s"></a>Installing Kubernetes using K3s</h3>
<div class="paragraph">
<p>K3s provides a quick way of installing Kubernetes. On your control node run the following command to install K3s:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -sfL https://get.k3s.io | sh -s - --write-kubeconfig-mode 644</code></pre>
</div>
</div>
<div class="paragraph">
<p>So long as you have an Internet connection K3s will download and automatically configure a simple Kubernetes environment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>root@kubernetes:~# curl -sfL https://get.k3s.io | sh -s - --write-kubeconfig-mode 644
[INFO]  Finding release for channel stable
[INFO]  Using v1.21.3+k3s1 as release
[INFO]  Downloading hash https://github.com/k3s-io/k3s/releases/download/v1.21.3+k3s1/sha256sum-amd64.txt
[INFO]  Downloading binary https://github.com/k3s-io/k3s/releases/download/v1.21.3+k3s1/k3s
[INFO]  Verifying binary download
[INFO]  Installing k3s to /usr/local/bin/k3s
[INFO]  Creating /usr/local/bin/kubectl symlink to k3s
[INFO]  Creating /usr/local/bin/crictl symlink to k3s
[INFO]  Creating /usr/local/bin/ctr symlink to k3s
[INFO]  Creating killall script /usr/local/bin/k3s-killall.sh
[INFO]  Creating uninstall script /usr/local/bin/k3s-uninstall.sh
[INFO]  env: Creating environment file /etc/systemd/system/k3s.service.env
[INFO]  systemd: Creating service file /etc/systemd/system/k3s.service
[INFO]  systemd: Enabling k3s unit
Created symlink /etc/systemd/system/multi-user.target.wants/k3s.service → /etc/systemd/system/k3s.service.
[INFO]  systemd: Starting k3s</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a symlink to the Kubernetes configuration from your home directory to allow tools like Helm to find the correct configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>mkdir ~/.kube
ln -s /etc/rancher/k3s/k3s.yaml ~/.kube/config</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_testing_your_kubernetes_installation"><a class="anchor" href="#_testing_your_kubernetes_installation"></a>Testing your Kubernetes installation</h3>
<div class="paragraph">
<p>To check if everything worked as expected you can use <code>kubectl cluster-info</code> to retrieve the cluster information.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>$ kubectl cluster-info
Kubernetes control plane is running at https://127.0.0.1:6443
CoreDNS is running at https://127.0.0.1:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy
Metrics-server is running at https://127.0.0.1:6443/api/v1/namespaces/kube-system/services/https:metrics-server:/proxy</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_installing_helm"><a class="anchor" href="#_installing_helm"></a>Installing Helm</h3>
<div class="paragraph">
<p>Stackable uses <a href="https://helm.sh/">Helm</a> as the package manager for its Kubernetes operators. This greatly simplifies the deployment and management of Kubernetes operators and CRDs. The quickest way to install Helm is to run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>curl -sfL https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3 | /bin/bash -</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installing_stackable"><a class="anchor" href="#_installing_stackable"></a>Installing Stackable</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_install_stackable_helm_repositories"><a class="anchor" href="#_install_stackable_helm_repositories"></a>Install Stackable Helm Repositories</h3>
<div class="paragraph">
<p>With Helm installed you can add the Stackable operator repo, where the helm charts to install Stackable operators can be found. There are development, test and a stable repositories available, we&#8217;ll be using the stable repo in this guide.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>helm repo add stackable-stable https://repo.stackable.tech/repository/helm-stable/</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_installing_stackable_operators"><a class="anchor" href="#_installing_stackable_operators"></a>Installing Stackable Operators</h3>
<div class="paragraph">
<p>The Stackable operators are components that translate the service definitions deployed via Kubernetes into deploy services on the worker nodes. These can be installed on any node that has access to the Kubernetes control plane. In this example we will install them on the controller node.</p>
</div>
<div class="paragraph">
<p>Stackable operators are installed using Helm charts. Run the following commands to install the operators for ZooKeeper, Kafka and NiFi using the repo configured earlier. The --devel flag will choose the latest available version; alternatively the --version flag can be used to deploy a specific version.</p>
</div>
<div class="sect3">
<h4 id="_installing_from_the_stackable_test_repository"><a class="anchor" href="#_installing_from_the_stackable_test_repository"></a>Installing from the Stackable test repository</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>helm install zookeeper-operator stackable-stable/zookeeper-operator --version=0.9.0
helm install kafka-operator stackable-stable/kafka-operator --version=0.5.0
helm install secret-operator stackable-stable/secret-operator --version=0.2.0
helm install nifi-operator stackable-stable/nifi-operator --version=0.5.0</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can check which operators are installed using <code>helm list</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>user@quickstart:~/stackable-utils/quickstart$ helm list
NAME              	NAMESPACE	REVISION	UPDATED                                	STATUS  	CHART                   	APP VERSION
kafka-operator    	default  	1       	2022-02-15 08:17:26.84659409 +0000 UTC 	deployed	kafka-operator-0.5.0    	0.5.0
nifi-operator     	default  	1       	2022-02-15 08:17:37.93720808 +0000 UTC 	deployed	nifi-operator-0.5.0     	0.5.0
secret-operator   	default  	1       	2022-02-15 08:17:32.700301793 +0000 UTC	deployed	secret-operator-0.2.0   	0.2.0
zookeeper-operator	default  	1       	2022-02-15 08:17:17.893844595 +0000 UTC	deployed	zookeeper-operator-0.9.0	0.9.0</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deploying_stackable_services"><a class="anchor" href="#_deploying_stackable_services"></a>Deploying Stackable Services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>At this point you’ve successfully deployed Kubernetes and the Stackable operators we need and are ready to deploy services to the cluster. To do this we provide service descriptions to Kubernetes for each of the services we wish to deploy.</p>
</div>
<div class="sect2">
<h3 id="_apache_zookeeper"><a class="anchor" href="#_apache_zookeeper"></a>Apache ZooKeeper</h3>
<div class="paragraph">
<p>We will deploy an Apache ZooKeeper instance to our cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>kubectl apply -f - &lt;&lt;EOF
---
apiVersion: zookeeper.stackable.tech/v1alpha1
kind: ZookeeperCluster
metadata:
  name: simple-zk
spec:
  servers:
    roleGroups:
      primary:
        replicas: 1
        config:
          myidOffset: 10
  version: 3.5.8
  stopped: false
EOF</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_apache_kafka"><a class="anchor" href="#_apache_kafka"></a>Apache Kafka</h3>
<div class="paragraph">
<p>We will deploy an Apache Kafka broker that depends on the ZooKeeper service we just deployed. The zookeeperReference property below points to the namespace and name we gave to the ZooKeeper service deployed previously.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>kubectl apply -f - &lt;&lt;EOF
---
apiVersion: kafka.stackable.tech/v1alpha1
kind: KafkaCluster
metadata:
  name: simple-kafka
spec:
  version: 2.8.1
  zookeeperConfigMapName: simple-kafka-znode
  brokers:
    roleGroups:
      brokers:
        replicas: 1
---
apiVersion: zookeeper.stackable.tech/v1alpha1
kind: ZookeeperZnode
metadata:
  name: simple-kafka-znode
spec:
  clusterRef:
    name: simple-zk
    namespace: default
EOF</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_apache_nifi"><a class="anchor" href="#_apache_nifi"></a>Apache NiFi</h3>
<div class="paragraph">
<p>We will next deploy an Apache NiFi server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>kubectl apply -f - &lt;&lt;EOF
---
apiVersion: zookeeper.stackable.tech/v1alpha1
kind: ZookeeperZnode
metadata:
  name: simple-nifi-znode
spec:
  clusterRef:
    name: simple-zk
---
apiVersion: v1
kind: Secret
metadata:
  name: nifi-admin-credentials-simple
stringData:
  username: admin
  password: AdminPassword
---
apiVersion: nifi.stackable.tech/v1alpha1
kind: NifiCluster
metadata:
  name: simple-nifi
spec:
  version: "1.15.0"
  zookeeperConfigMapName: simple-nifi-znode
  authenticationConfig:
    method:
      SingleUser:
        adminCredentialsSecret:
          name: nifi-admin-credentials-simple
        autoGenerate: true
  sensitivePropertiesConfig:
    keySecret: nifi-sensitive-property-key
    autoGenerate: true
  nodes:
    roleGroups:
      default:
        selector:
          matchLabels:
            kubernetes.io/os: linux
        config:
          log:
            rootLogLevel: INFO
        replicas: 1
EOF</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can check the status of the services using <code>kubectl get pods</code>. This will retrieve the status of all pods running in the default namespace.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>root@kubernetes:~# kubectl get pods
$ kubectl get pods
NAME                                             READY   STATUS    RESTARTS   AGE
nifi-operator-deployment-64c98c779c-nw6h8        1/1     Running   0          24m
kafka-operator-deployment-54df9f86c7-psqgd       1/1     Running   0          24m
zookeeper-operator-deployment-767458d4f5-2czb9   1/1     Running   0          24m
secret-operator-daemonset-pddkv                  2/2     Running   0          24m
simple-zk-server-primary-0                       1/1     Running   0          23m
simple-kafka-broker-brokers-0                    2/2     Running   0          21m
simple-nifi-node-default-0                       1/1     Running   0          22m</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since this is the first time that each of these services has been deployed to these nodes the Stackable Agent needs to download the software from the Stackable repository. It may take a few minutes to complete the download and deploy the services. Once all of the pods are in the running state your cluster should be ready to use.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing_your_cluster"><a class="anchor" href="#_testing_your_cluster"></a>Testing your cluster</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If all has gone well then you will have successfully deployed a Stackable cluster and used it to start three services that should now be ready for you.</p>
</div>
<div class="sect2">
<h3 id="_apache_zookeeper_2"><a class="anchor" href="#_apache_zookeeper_2"></a>Apache ZooKeeper</h3>
<div class="paragraph">
<p>We can test ZooKeeper by running the ZooKeeper CLI shell. The easiest way to do this is to run the CLI shell on the pod that is running ZooKeeper.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>kubectl exec -i -t simple-zk-server-primary-0 -- bin/zkCli.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>The shell should connect automatically to the ZooKeeper server running on the pod. You can run the <code>ls /</code> command to see the list of znodes in the root path, which should include those created by Apache Kafka and Apache NiFi.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>[zk: localhost:2181(CONNECTED) 0] ls /
[nifi, znode-17b28a7e-0d45-450b-8209-871225c6efa1, zookeeper]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_apache_kafka_2"><a class="anchor" href="#_apache_kafka_2"></a>Apache Kafka</h3>
<div class="paragraph">
<p>To test Kafka we&#8217;ll use the tool <code>kafkacat</code>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo apt install kafkacat</pre>
</div>
</div>
<div class="paragraph">
<p>With <code>kafkacat</code> installed we can connect to Kafka and query the metadata on the broker running on localhost. To do this we first need to find which port Kafka is listening on.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>$ kubectl get svc simple-kafka
NAME           TYPE       CLUSTER-IP   EXTERNAL-IP   PORT(S)          AGE
simple-kafka   NodePort   10.43.20.5   &lt;none&gt;        9092:31909/TCP   44m</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here we can the see default Kafka port 9092 has been mapped to port 31909. We can use this to configure kafkacat to connect to the broker.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>$ kafkacat -b localhost:31909 -L
Metadata for all topics (from broker -1: localhost:31909/bootstrap):
1 brokers:
broker 1001 at 192.168.40.120:31976 (controller)
0 topics:</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_apache_nifi_2"><a class="anchor" href="#_apache_nifi_2"></a>Apache NiFi</h3>
<div class="paragraph">
<p>Apache NiFi provides a web interface and the easiest way to test it is to view this in a web browser. As with the Kafka example above we need to find which port NiFi is listening on.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>$ kubectl get svc simple-nifi
NAME          TYPE       CLUSTER-IP    EXTERNAL-IP   PORT(S)          AGE
simple-nifi   NodePort   10.43.75.25   &lt;none&gt;        8443:30247/TCP   49m</code></pre>
</div>
</div>
<div class="paragraph">
<p>Browse to the address of your Kubernetes node on port 30247 e.g. <a href="https://quickstart.local:30247/nifi" class="bare">https://quickstart.local:30247/nifi</a> and you should see the NiFi login screen.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/nifi_login_screen.png" alt="The Apache NiFi web interface login screen"></span></p>
</div>
<div class="paragraph">
<p>The Apache NiFi operator will automatically generate the admin user credentials with a random password and store it as a Kubernetes secret in order to provide some security out of the box. You can retrieve this password for the admin user with the following kubectl command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>kubectl get secrets nifi-admin-credentials-simple -o jsonpath="{.data.password}" | base64 -d &amp;&amp; echo
4tkInc6UyBuWvbc</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your password will be different to the one above and will be different every time you install a new cluster. Once you have these credentials you can login and you should see a blank NiFi canvas.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/nifi_menu.png" alt="The Apache NiFi web interface canvas"></span></p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
</footer>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>

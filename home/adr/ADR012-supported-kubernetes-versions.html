<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ADR012: Supported Kubernetes versions :: Stackable Documentation</title>
    <link rel="canonical" href="https://docs.stackable.tech/home/adr/ADR012-supported-kubernetes-versions.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.stackable.tech">Stackable Documentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="home" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Stackable Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../getting_started.html">Getting Started</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../supported-versions.html">Supported Product Versions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../monitoring.html">Monitoring</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Internal Docs</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../internal/personas.html">Customer Personas</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Stackable Documentation</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Stackable Documentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../airflow/index.html">Stackable Operator for Apache Airflow</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../airflow/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../druid/index.html">Stackable Operator for Apache Druid</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../druid/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../hbase/index.html">Stackable Operator for Apache HBase</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../hbase/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../hdfs/index.html">Stackable Operator for Apache HDFS</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../hdfs/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../hive/index.html">Stackable Operator for Apache Hive</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../hive/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../kafka/index.html">Stackable Operator for Apache Kafka</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../kafka/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../nifi/index.html">Stackable Operator for Apache NiFi</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../nifi/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../spark/index.html">Stackable Operator for Apache Spark</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../spark/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../superset/index.html">Stackable Operator for Apache Superset</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../superset/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../zookeeper/index.html">Stackable Operator for Apache ZooKeeper</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../zookeeper/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../monitoring/index.html">Stackable Operator for Monitoring and Metrics</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../monitoring/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../opa/index.html">Stackable Operator for OpenPolicyAgent</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../opa/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../regorule/index.html">Stackable Operator for OpenPolicyAgent Rego rules</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../regorule/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../trino/index.html">Stackable Operator for Trino</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../trino/index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Stackable Documentation</a></li>
    <li><a href="ADR012-supported-kubernetes-versions.html">ADR012: Supported Kubernetes versions</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/stackabletech/documentation/edit/main/modules/adr/pages/ADR012-supported-kubernetes-versions.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">ADR012: Supported Kubernetes versions</h1>
<div id="preamble">
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Status: draft</p>
</li>
<li>
<p>Deciders: Lars Francke</p>
</li>
<li>
<p>Date: 2022-02-04</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Technical Story: <a href="https://github.com/stackabletech/documentation/issues/83">Document supported Kubernetes versions</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_context_and_problem_statement"><a class="anchor" href="#_context_and_problem_statement"></a>Context and Problem Statement</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_kubernetes_version_policy"><a class="anchor" href="#_kubernetes_version_policy"></a>Kubernetes Version Policy</h3>
<div class="paragraph">
<p>Multiple new versions of Kubernetes are released every year (currently 3). Security fixes might come in between. Different Kubernetes components (including kubectl) will only support a limited number of versions, as mandated by kubernetes' <a href="https://kubernetes.io/releases/version-skew-policy/">Version Skew Policy</a>. Therefore, we need to define the supported Kubernetes versions.</p>
</div>
</div>
<div class="sect2">
<h3 id="_deprecation_and_removal_of_older_resource_variants"><a class="anchor" href="#_deprecation_and_removal_of_older_resource_variants"></a>Deprecation and Removal of older resource variants</h3>
<div class="paragraph">
<p>The API overview provides an overview of the <a href="https://kubernetes.io/docs/reference/using-api/deprecation-policy/#deprecating-a-feature-or-behavior">Kubernetes Deprecation Policy</a>. In there, we find rules that can guide our decisions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"Rule #4a: minimum API lifetime is determined by the API stability level"</p>
<div class="ulist">
<ul>
<li>
<p>"Alpha API versions may be removed in any release without prior deprecation notice"</p>
</li>
<li>
<p>"Beta API versions must be supported for 9 months or 3 releases (whichever is longer) after deprecation"</p>
</li>
<li>
<p>"GA API versions may be marked as deprecated, but must not be removed within a major version of Kubernetes"</p>
</li>
</ul>
</div>
</li>
<li>
<p>"Rule #7: Deprecated behaviors must function for no less than 1 year after their announced deprecation."</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This means that a codebase relying on alpha features can only reliably be developed against a single kubernetes version. For beta features, 3 kubernetes versions can be covered with the same codebase. The linked document also shows the overlapping of versions. When a feature matures from beta into stable, the beta version can still be used for 3 releases. After that, the stable version has to be used.</p>
</div>
<div class="paragraph">
<p>For actually deprecated features (not just moved from beta to stable), the grace period is also more than three releases; as specified a deprecated feature has to be supported for at least a year.</p>
</div>
</div>
<div class="sect2">
<h3 id="_stackables_behavior"><a class="anchor" href="#_stackables_behavior"></a>Stackables behavior</h3>
<div class="paragraph">
<p>The stackable operators depend on a specific kubernetes version through the <a href="https://github.com/stackabletech/operator-rs">operator framework</a>. At the moment we do not have an explicit version compatibility, and the software will work with different versions of the objects we use are the same in different kubernetes versions (i.e. an operator uses 1.21 but all resource definitions we rely on are identical in 1.20 so the operator works in 1.20 too).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_support_policies_of_kubernetes_and_managed_cluster_providers"><a class="anchor" href="#_support_policies_of_kubernetes_and_managed_cluster_providers"></a>Support Policies of Kubernetes and Managed Cluster Providers</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_kubernetes"><a class="anchor" href="#_kubernetes"></a>Kubernetes</h3>
<div class="paragraph">
<p>Kubernetes maintains release branches for the most recent three minor releases. Any minor version for 1.19 onwards receives one year of patch support. Most providers of managed kubernetes refer to this schedule when defining their own support windows.</p>
</div>
<div class="paragraph">
<p>See <a href="https://kubernetes.io/releases/" class="bare">https://kubernetes.io/releases/</a> and <a href="https://kubernetes.io/releases/version-skew-policy/" class="bare">https://kubernetes.io/releases/version-skew-policy/</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_azure_kubernetes_service_aks"><a class="anchor" href="#_azure_kubernetes_service_aks"></a>Azure Kubernetes Service (AKS)</h3>
<div class="paragraph">
<p>AKS supports three kubernetes versions, where they seem to try to make these the three latest versions.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.microsoft.com/en-us/azure/aks/supported-kubernetes-versions?tabs=azure-cli#kubernetes-version-support-policy" class="bare">https://docs.microsoft.com/en-us/azure/aks/supported-kubernetes-versions?tabs=azure-cli#kubernetes-version-support-policy</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_amazon_eks"><a class="anchor" href="#_amazon_eks"></a>Amazon EKS</h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Each minor version is supported for approximately twelve months after it&#8217;s first released.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>See <a href="https://docs.aws.amazon.com/eks/latest/userguide/kubernetes-versions.html" class="bare">https://docs.aws.amazon.com/eks/latest/userguide/kubernetes-versions.html</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_google_gke"><a class="anchor" href="#_google_gke"></a>Google GKE</h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Google provides a total of 14 months of support for each GKE minor version once the version has been made available in the Regular channel. [&#8230;&#8203;] After 12 months, a supported version will enter a 2-month maintenance period before reaching end of life.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>See <a href="https://cloud.google.com/kubernetes-engine/versioning" class="bare">https://cloud.google.com/kubernetes-engine/versioning</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_ionos"><a class="anchor" href="#_ionos"></a>IONOS</h3>
<div class="paragraph">
<p>IONOS seems to support the latest three versions; as of January 2022 the supported versions are 1.20, 1.21 and 1.22.</p>
</div>
</div>
<div class="sect2">
<h3 id="_openshift"><a class="anchor" href="#_openshift"></a>OpenShift</h3>
<div class="paragraph">
<p>As of September 2021, the supported OpenShift Container Platforms are 4.6, 4.7, and 4.8 which in turn use Kubernetes v1.19, v1.20, and v1.21.</p>
</div>
<div class="paragraph">
<p>see <a href="https://docs.openshift.com/container-platform/4.6/release_notes/ocp-4-6-release-notes.html#ocp-4-6-about-this-release" class="bare">https://docs.openshift.com/container-platform/4.6/release_notes/ocp-4-6-release-notes.html#ocp-4-6-about-this-release</a>
see <a href="https://docs.openshift.com/container-platform/4.7/release_notes/ocp-4-7-release-notes.html#ocp-4-7-about-this-release" class="bare">https://docs.openshift.com/container-platform/4.7/release_notes/ocp-4-7-release-notes.html#ocp-4-7-about-this-release</a>
see <a href="https://docs.openshift.com/container-platform/4.8/release_notes/ocp-4-8-release-notes.html#ocp-4-8-about-this-release" class="bare">https://docs.openshift.com/container-platform/4.8/release_notes/ocp-4-8-release-notes.html#ocp-4-8-about-this-release</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_decision_drivers"><a class="anchor" href="#_decision_drivers"></a>Decision Drivers</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Some customers told us they have troubles keeping the pace at which Kubernetes moves. They are only slowly adopting new Kubernetes releases, or even refrain completely from using Kubernetes. Customers might even be lagging behind in their Kubernetes clusters. This means that too fast a pace is not good for customers.</p>
</li>
<li>
<p>Tech is fast moving: major Kubernetes improvements are released multiple times a year. This means that we need to stay up to date, supporting versions that are not supported by the kubernetes project is potentially difficult.</p>
</li>
<li>
<p>Managed Kubernetes offerings (GKE &amp; Co.) typically only support fairly recent k8s releases. We should be able to run on all large managed kubernetes services.</p>
</li>
<li>
<p>How can we upgrade the Kubernetes we run without customer intervention?</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_considered_options"><a class="anchor" href="#_considered_options"></a>Considered Options</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>follow Kubernetes support timeline/version skew policy</p>
<div class="ulist">
<ul>
<li>
<p>needs an outline of migration strategy, announcements, communications and paths</p>
</li>
</ul>
</div>
</li>
<li>
<p>support any Kubernetes Version for n months</p>
<div class="ulist">
<ul>
<li>
<p>needs an outline of migration strategy</p>
</li>
</ul>
</div>
</li>
<li>
<p>identify Stackable&#8217;s own long-term-support version of Kubernetes</p>
<div class="ulist">
<ul>
<li>
<p>outline additional effort, like handling of security patches, and how to deal with missing new mainstream features</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_decision_outcome"><a class="anchor" href="#_decision_outcome"></a>Decision Outcome</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It was decided that we will support the latest three kubernetes versions. Kubernetes release cycle is approximately 15 weeks, which means we support each version for 45 weeks or a little over 10 months.</p>
</div>
<div class="sect2">
<h3 id="_positive_consequences"><a class="anchor" href="#_positive_consequences"></a>Positive Consequences</h3>
<div class="paragraph">
<p>According to the deprecation policy this means that we will have a single API version for every object across all 3 versions available, so we will be able to compile a single binary that works with all 3 versions of kubernetes.</p>
</div>
<div class="paragraph">
<p>In general, having to support less means we can focus more on building new features instead of maintaining compatibility over a large range of kubernetes versions.</p>
</div>
</div>
<div class="sect2">
<h3 id="_negative_consequences"><a class="anchor" href="#_negative_consequences"></a>Negative Consequences</h3>
<div class="paragraph">
<p>This speed might be too fast for some users.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_links"><a class="anchor" href="#_links"></a>Links</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://kubernetes.io/releases/version-skew-policy/">Kubernetes Version Skew Policy</a></p>
</li>
<li>
<p><a href="https://kubernetes.io/blog/2021/07/20/new-kubernetes-release-cadence/">Kubernetes Release Cadence</a></p>
</li>
<li>
<p><a href="https://kubernetes.io/docs/reference/using-api/deprecation-policy/">Kubernetes Deprecation Policy</a></p>
</li>
</ul>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>

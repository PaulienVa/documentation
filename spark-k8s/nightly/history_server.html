<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Spark History Server :: Stackable Documentation</title>
    <link rel="canonical" href="https://docs.stackable.tech/spark-k8s/stable/history_server.html">
    <meta name="generator" content="Antora 3.1.0">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script type="text/javascript"> var tCPrivacyTagManager = "gtm"; </script>
    <script>
        var consent = document.createElement("script");
        if(window.location.pathname.indexOf("/en/") > -1){
            // Default is EN Cookie Banner if /en/ in path
            consent.src = "https://cdn.trustcommander.net/privacy/4616/privacy_v2_27.js";
        } else {
            // Default is DE Cookie Banner
            consent.src = "https://cdn.trustcommander.net/privacy/4616/privacy_v2_9.js";
        }
        consent.type = "text/javascript";
        document.head.appendChild(consent);
    </script>
    <!-- Matomo consent with trustcommander -->
    <script type="text/tc_privacy" data-category="2">
    console.log('consent provided for Matomo')
    <!-- Matomo -->
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setCookieDomain", "*.stackable.tech"]);
    _paq.push(["setDomains", ["*.stackable.tech"]]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
        var u="https://stackable.matomo.cloud/";
        _paq.push(['setTrackerUrl', u+'matomo.php']);
        _paq.push(['setSiteId', '2']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.async=true; g.src='//cdn.matomo.cloud/stackable.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
    })();
    </script>
    <!-- End Matomo Code -->
    <script>var uiRootPath = '../../_'</script>
    <link rel="icon" href="../../_/img/favicon.png" type="image/png">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://stackable.tech"><img src="../../_/img/stackable-logo.png"></a>
      <a class="navbar-item documentation-link" href="https://docs.stackable.tech">Documentation</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search...">
        </div>
      </div>
      <button class="navbar-burger" data-target="navbar-sub">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <a href="https://www.stackable.tech/contact/" class="button pull-right">Contact Us</a>
    </div>
      <div id="topbar-nav" class="navbar-menu">
      </div>
      </div>
    </nav>
    <nav id="navbar-sub" class="navbar-sub">
      <div class="container">
<a class="navbar-sub-item" href="../../home/stable/index.html">Home</a>
<a class="navbar-sub-item" href="../../home/stable/getting_started.html">Getting Started</a>
<a class="navbar-sub-item" href="../../home/stable/concepts/index.html">Concepts</a>
<a class="navbar-sub-item" href="../../home/stable/tutorials/end-to-end_data_pipeline_example.html">Tutorials</a>
<a class="navbar-sub-item" href="../../stackablectl/stable/index.html">stackablectl</a>
<div class="navbar-sub-item drop-down">
    Operators
    <div class="drop-down-content">
        <a class="drop-down-item" href="../../home/stable/operators/index.html">Overview</a>
        <a class="drop-down-item" href="../../airflow/stable/index.html">Apache Airflow</a>
        <a class="drop-down-item" href="../../druid/stable/index.html">Apache Druid</a>
        <a class="drop-down-item" href="../../hbase/stable/index.html">Apache HBase</a>
        <a class="drop-down-item" href="../../hdfs/stable/index.html">Apache Hadoop HDFS</a>
        <a class="drop-down-item" href="../../hive/stable/index.html">Apache Hive</a>
        <a class="drop-down-item" href="../../kafka/stable/index.html">Apache Kafka</a>
        <a class="drop-down-item" href="../../nifi/stable/index.html">Apache NiFi</a>
        <a class="drop-down-item" href="../stable/index.html">Apache Spark on K8S</a>
        <a class="drop-down-item" href="../../superset/stable/index.html">Apache Superset</a>
        <a class="drop-down-item" href="../../trino/stable/index.html">Trino</a>
        <a class="drop-down-item" href="../../zookeeper/stable/index.html">Apache ZooKeeper</a>
        <a class="drop-down-item" href="../../opa/stable/index.html">OpenPolicyAgent</a>
        <a class="drop-down-item" href="../../commons-operator/stable/index.html">Commons</a>
        <a class="drop-down-item" href="../../secret-operator/stable/index.html">Secret</a>
        <a class="drop-down-item" href="../../listener-operator/stable/index.html">Listener</a>
    </div>
</div>
<a class="navbar-sub-item" href="../../home/stable/contributor/index.html">Contribute</a>

        <a class="arrow" href="javascript:document.querySelector('.navbar-sub').classList.toggle('open')">
          <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="arrow-right" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"></path></svg>
        </a>
      </div>
    </nav>
  </header>
<div class="body">
    <div class="container">
<div class="nav-container" data-component="spark-k8s" data-version="nightly">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <div class="title-wrapper">
      <h3 class="title"><a href="index.html">Stackable Operator for Apache Spark on Kubernetes</a></h3>
      <div class="page-versions">
        <button class="version-menu-toggle" title="Show other versions of page">nightly</button>
        <div class="version-menu">
          <a class="version is-current" href="history_server.html">nightly</a>
          <a class="version" href="../stable/history_server.html">23.1</a>
          <a class="version is-missing" href="../0.6/index.html">0.6</a>
          <a class="version is-missing" href="../0.5/index.html">0.5</a>
          <a class="version is-missing" href="../0.4/index.html">0.4</a>
          <a class="version is-missing" href="../0.3/index.html">0.3</a>
          <a class="version is-missing" href="../0.2/index.html">0.2</a>
        </div>
      </div>
    </div>
    <ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="getting_started/index.html">Getting started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="getting_started/installation.html">Installation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="getting_started/first_steps.html">First steps</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="configuration.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="usage.html">Usage</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="job_dependencies.html">Job Dependencies</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="rbac.html">RBAC</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="history_server.html">Spark History Server</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Stackable Operator for Apache Spark on Kubernetes</span>
    <span class="version">nightly</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../commons-operator/stable/index.html">Stackable Commons Operator</a>
      <ul class="versions">
        <li class="version">
          <a href="../../commons-operator/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../commons-operator/stable/index.html">23.1</a>
        </li>
        <li class="version">
          <a href="../../commons-operator/0.4/index.html">0.4</a>
        </li>
        <li class="version">
          <a href="../../commons-operator/0.3/index.html">0.3</a>
        </li>
        <li class="version">
          <a href="../../commons-operator/0.2/index.html">0.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../home/stable/index.html">Stackable Documentation</a>
      <ul class="versions">
        <li class="version">
          <a href="../../home/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../home/stable/index.html">22.11</a>
        </li>
        <li class="version">
          <a href="../../home/22.09/index.html">22.09</a>
        </li>
        <li class="version">
          <a href="../../home/22.06/index.html">22.06</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../listener-operator/stable/index.html">Stackable Listener Operator</a>
      <ul class="versions">
        <li class="version">
          <a href="../../listener-operator/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../listener-operator/stable/index.html">23.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../airflow/stable/index.html">Stackable Operator for Apache Airflow</a>
      <ul class="versions">
        <li class="version">
          <a href="../../airflow/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../airflow/stable/index.html">23.1</a>
        </li>
        <li class="version">
          <a href="../../airflow/0.6/index.html">0.6</a>
        </li>
        <li class="version">
          <a href="../../airflow/0.5/index.html">0.5</a>
        </li>
        <li class="version">
          <a href="../../airflow/0.4/index.html">0.4</a>
        </li>
        <li class="version">
          <a href="../../airflow/0.3/index.html">0.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../druid/stable/index.html">Stackable Operator for Apache Druid</a>
      <ul class="versions">
        <li class="version">
          <a href="../../druid/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../druid/stable/index.html">23.1</a>
        </li>
        <li class="version">
          <a href="../../druid/0.8/index.html">0.8</a>
        </li>
        <li class="version">
          <a href="../../druid/0.7/index.html">0.7</a>
        </li>
        <li class="version">
          <a href="../../druid/0.6/index.html">0.6</a>
        </li>
        <li class="version">
          <a href="../../druid/0.2/index.html">0.2</a>
        </li>
        <li class="version">
          <a href="../../druid/0.1/index.html">0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../hbase/stable/index.html">Stackable Operator for Apache HBase</a>
      <ul class="versions">
        <li class="version">
          <a href="../../hbase/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../hbase/stable/index.html">23.1</a>
        </li>
        <li class="version">
          <a href="../../hbase/0.5/index.html">0.5</a>
        </li>
        <li class="version">
          <a href="../../hbase/0.4/index.html">0.4</a>
        </li>
        <li class="version">
          <a href="../../hbase/0.3/index.html">0.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../hdfs/stable/index.html">Stackable Operator for Apache HDFS</a>
      <ul class="versions">
        <li class="version">
          <a href="../../hdfs/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../hdfs/stable/index.html">23.1</a>
        </li>
        <li class="version">
          <a href="../../hdfs/0.6/index.html">0.6</a>
        </li>
        <li class="version">
          <a href="../../hdfs/0.5/index.html">0.5</a>
        </li>
        <li class="version">
          <a href="../../hdfs/0.4/index.html">0.4</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../hive/stable/index.html">Stackable Operator for Apache Hive</a>
      <ul class="versions">
        <li class="version">
          <a href="../../hive/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../hive/stable/index.html">23.1</a>
        </li>
        <li class="version">
          <a href="../../hive/0.8/index.html">0.8</a>
        </li>
        <li class="version">
          <a href="../../hive/0.7/index.html">0.7</a>
        </li>
        <li class="version">
          <a href="../../hive/0.6/index.html">0.6</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../kafka/stable/index.html">Stackable Operator for Apache Kafka</a>
      <ul class="versions">
        <li class="version">
          <a href="../../kafka/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../kafka/stable/index.html">23.1</a>
        </li>
        <li class="version">
          <a href="../../kafka/0.8/index.html">0.8</a>
        </li>
        <li class="version">
          <a href="../../kafka/0.7/index.html">0.7</a>
        </li>
        <li class="version">
          <a href="../../kafka/0.6/index.html">0.6</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../nifi/stable/index.html">Stackable Operator for Apache NiFi</a>
      <ul class="versions">
        <li class="version">
          <a href="../../nifi/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../nifi/stable/index.html">23.1</a>
        </li>
        <li class="version">
          <a href="../../nifi/0.8/index.html">0.8</a>
        </li>
        <li class="version">
          <a href="../../nifi/0.7/index.html">0.7</a>
        </li>
        <li class="version">
          <a href="../../nifi/0.6/index.html">0.6</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../stable/index.html">Stackable Operator for Apache Spark on Kubernetes</a>
      <ul class="versions">
        <li class="version is-current">
          <a href="index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../stable/index.html">23.1</a>
        </li>
        <li class="version">
          <a href="../0.6/index.html">0.6</a>
        </li>
        <li class="version">
          <a href="../0.5/index.html">0.5</a>
        </li>
        <li class="version">
          <a href="../0.4/index.html">0.4</a>
        </li>
        <li class="version">
          <a href="../0.3/index.html">0.3</a>
        </li>
        <li class="version">
          <a href="../0.2/index.html">0.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../superset/stable/index.html">Stackable Operator for Apache Superset</a>
      <ul class="versions">
        <li class="version">
          <a href="../../superset/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../superset/stable/index.html">23.1</a>
        </li>
        <li class="version">
          <a href="../../superset/0.7/index.html">0.7</a>
        </li>
        <li class="version">
          <a href="../../superset/0.6/index.html">0.6</a>
        </li>
        <li class="version">
          <a href="../../superset/0.5/index.html">0.5</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../zookeeper/stable/index.html">Stackable Operator for Apache ZooKeeper</a>
      <ul class="versions">
        <li class="version">
          <a href="../../zookeeper/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../zookeeper/stable/index.html">23.1</a>
        </li>
        <li class="version">
          <a href="../../zookeeper/0.12/index.html">0.12</a>
        </li>
        <li class="version">
          <a href="../../zookeeper/0.11/index.html">0.11</a>
        </li>
        <li class="version">
          <a href="../../zookeeper/0.10/index.html">0.10</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../opa/stable/index.html">Stackable Operator for OPA</a>
      <ul class="versions">
        <li class="version">
          <a href="../../opa/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../opa/stable/index.html">23.1</a>
        </li>
        <li class="version">
          <a href="../../opa/0.11/index.html">0.11</a>
        </li>
        <li class="version">
          <a href="../../opa/0.10/index.html">0.10</a>
        </li>
        <li class="version">
          <a href="../../opa/0.9/index.html">0.9</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../trino/stable/index.html">Stackable Operator for Trino</a>
      <ul class="versions">
        <li class="version">
          <a href="../../trino/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../trino/stable/index.html">23.1</a>
        </li>
        <li class="version">
          <a href="../../trino/0.8/index.html">0.8</a>
        </li>
        <li class="version">
          <a href="../../trino/0.7/index.html">0.7</a>
        </li>
        <li class="version">
          <a href="../../trino/0.6/index.html">0.6</a>
        </li>
        <li class="version">
          <a href="../../trino/0.5/index.html">0.5</a>
        </li>
        <li class="version">
          <a href="../../trino/0.4/index.html">0.4</a>
        </li>
        <li class="version">
          <a href="../../trino/0.3/index.html">0.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../secret-operator/stable/index.html">Stackable Secret Operator</a>
      <ul class="versions">
        <li class="version">
          <a href="../../secret-operator/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../secret-operator/stable/index.html">23.1</a>
        </li>
        <li class="version">
          <a href="../../secret-operator/0.6/index.html">0.6</a>
        </li>
        <li class="version">
          <a href="../../secret-operator/0.5/index.html">0.5</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../stackablectl/stable/index.html">stackablectl</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../stackablectl/stable/index.html">nightly</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../home/stable/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Stackable Operator for Apache Spark on Kubernetes</a></li>
    <li><a href="history_server.html">Spark History Server</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/stackabletech/spark-k8s-operator/edit/main/docs/modules/ROOT/pages/history_server.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Spark History Server</h1>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Stackable Spark-on-Kubernetes operator runs Apache Spark workloads in a Kubernetes cluster, whereby driver- and executor-pods are created for the duration of the job and then terminated. One or more Spark History Server instances can be deployed independently of <code>SparkApplication</code> jobs and used as an end-point for spark logging, so that job information can be viewed once the job pods are no longer available.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deployment"><a class="anchor" href="#_deployment"></a>Deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The example below demonstrates how to set up the history server running in one Pod with scheduled cleanups of the event logs. The event logs are loaded from an S3 bucket named <code>spark-logs</code> and the folder <code>eventlogs/</code>. The credentials for this bucket are provided by the secret class <code>s3-credentials-class</code>. For more details on how the Stackable Data Platform manages S3 resources see the <a href="../../home/stable/concepts/s3.html" class="xref page">S3 resources</a> page.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">---
apiVersion: spark.stackable.tech/v1alpha1
kind: SparkHistoryServer
metadata:
  name: spark-history
spec:
  image:
    productVersion: 3.3.0
    stackableVersion: 0.3.0
  logFileDirectory:  <i class="conum" data-value="1"></i><b>(1)</b>
    s3:
      prefix: eventlogs/  <i class="conum" data-value="2"></i><b>(2)</b>
      bucket:  <i class="conum" data-value="3"></i><b>(3)</b>
        inline:
          bucketName: spark-logs
          connection:
            inline:
              host: test-minio
              port: 9000
              accessStyle: Path
              credentials:
                secretClass: history-credentials-class
  sparkConf:  <i class="conum" data-value="4"></i><b>(4)</b>
  nodes:
    roleGroups:
      cleaner:
        replicas: 1  <i class="conum" data-value="5"></i><b>(5)</b>
        config:
          cleaner: true <i class="conum" data-value="6"></i><b>(6)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The location of the event logs. Must be a S3 bucket. Future implementations might add support for other shared filesystems such as HDFS.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Folder within the S3 bucket where the log files are located. This folder is required and must exist before setting up the history server.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The S3 bucket definition, here provided in-line.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Additional history server configuration properties can be provided here as a map. For possible properties see: <a href="https://spark.apache.org/docs/latest/monitoring.html#spark-history-server-configuration-options" class="bare">https://spark.apache.org/docs/latest/monitoring.html#spark-history-server-configuration-options</a></td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>This deployment has only one Pod. Multiple history servers can be started, all reading the same event logs by increasing the replica count.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>This history server will automatically clean up old log files by using default properties. You can change any of these by using the <code>sparkConf</code> map.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Only one role group can have scheduled cleanups enabled (<code>cleaner: true</code>) and this role group cannot have more than 1 replica.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The secret with S3 credentials must contain at least the following two keys:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>accessKey</code> - the access key of a user with read and write access to the event log bucket.</p>
</li>
<li>
<p><code>secretKey</code> - the secret key of a user with read and write access to the event log bucket.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any other entries of the Secret are ignored by the operator.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_application_configuration"><a class="anchor" href="#_application_configuration"></a>Application configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The example below demonstrates how to configure Spark applications to write log events to an S3 bucket.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">---
apiVersion: spark.stackable.tech/v1alpha1
kind: SparkApplication
metadata:
  name: spark-pi-s3-1
spec:
  version: "1.0"
  sparkImage: docker.stackable.tech/stackable/spark-k8s:3.3.0-stackable0.3.0
  sparkImagePullPolicy: IfNotPresent
  mode: cluster
  mainClass: org.apache.spark.examples.SparkPi
  mainApplicationFile: s3a://my-bucket/spark-examples_2.12-3.3.0.jar
  s3connection: <i class="conum" data-value="1"></i><b>(1)</b>
    inline:
      host: test-minio
      port: 9000
      accessStyle: Path
      credentials:
        secretClass: s3-credentials-class <i class="conum" data-value="2"></i><b>(2)</b>
  logFileDirectory: <i class="conum" data-value="3"></i><b>(3)</b>
    s3:
      prefix: eventlogs/ <i class="conum" data-value="4"></i><b>(4)</b>
      bucket:
        inline:
          bucketName: spark-logs <i class="conum" data-value="5"></i><b>(5)</b>
          connection:
            inline:
              host: test-minio
              port: 9000
              accessStyle: Path
              credentials:
                secretClass: history-credentials-class <i class="conum" data-value="6"></i><b>(6)</b>
  executor:
    instances: 1</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Location of the data that is being processed by the application.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Credentials used to access the data above.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Instruct the operator to configure the application with logging enabled.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Folder to store logs. This must match the prefix used by the history server.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Bucket to store logs. This must match the bucket used by the history server.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Credentials used to write event logs. These can, of course, differ from the credentials used to process data.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_history_web_ui"><a class="anchor" href="#_history_web_ui"></a>History Web UI</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To access the history server web UI, use one of the <code>NodePort</code> services created by the operator. For the example above, the operator created two services as shown:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ kubectl get svc
NAME                         TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)             AGE
spark-history-node           NodePort    10.96.222.233   &lt;none&gt;        18080:30136/TCP     52m
spark-history-node-cleaner   NodePort    10.96.203.43    &lt;none&gt;        18080:32585/TCP     52m</code></pre>
</div>
</div>
<div class="paragraph">
<p>By setting up port forwarding on 18080 the UI can be opened by pointing your browser to <code><a href="http://localhost:18080" class="bare">http://localhost:18080</a></code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/history-server-ui.png" alt="History Server Console">
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
    </div>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-container">
      <!-- link columns -->
      <div class="footer-info">
        <div class="footer-info-item-large">
          <img src="../../_/img/logo-2-1.png">
          <p>
            your data, your platform
          </p>
        </div>
        <div class="footer-info-item">
          <h2>Company</h2>
          <ul class="footer-link-list">
            <li>
              <a href="https://stackable.tech/en/about-us">About Us</a>
            </li>
            <li>
              <a href="https://stackable.tech/en/blog">Blog</a>
            </li>
            <li>
              <a href="https://jobs.stackable.de/" target="_blank">Jobs</a>
            </li>
          </ul>
        </div>
        <div class="footer-info-item">
          <h2>Support</h2>
          <ul class="footer-link-list">
            <li>
              <a href="https://stackable.tech/en/contact">Contact Us</a>
            </li>
            <li>
              <a href="https://stackable.tech/en/imprint">Imprint</a>
            </li>
            <li>
              <a href="https://stackable.tech/en/data-protection">Data Protection</a>
            </li>
          </ul>
        </div>
        <div class="footer-info-item">
          <h2>Get in touch</h2>
          <ul class="footer-link-list">
            <li>
              <a href="mailto:info@stackable.de">info@stackable.de</a>
            </li>
            <li>
              <a href="tel:+4941039263100">+49 4103 926 3100</a>
            </li>
          </ul>
        </div>
      </div>
      <div class="footer-seperator"></div>
      <!-- social links -->
      <div class="c-and-socials">
        <div>© 2022 Stackable.</div>
        <div class="social-icons-container">
          <a class="social-icon" href="https://www.xing.com/pages/stackable" target="_blank">
            <i class="fab fa-xing"></i>
          </a>
          <a class="social-icon" href="https://www.linkedin.com/company/stackabletech/" target="_blank">
            <i class="fab fa-linkedin"></i>
          </a>
          <a class="social-icon" href="https://github.com/stackabletech" target="_blank">
            <i class="fab fa-github"></i>
          </a>
          <a class="social-icon" href="https://twitter.com/stackabletech" target="_blank">
            <i class="fab fa-twitter"></i>
          </a>
        </div>
      </div>
      <!-- copyright notice -->
      <p>
        Apache, Apache Kafka®, Kafka, and the Kafka logo, Apache Druid, Druid, and the Druid logo,
        Apache ZooKeeper™, ZooKeeper, and the Druid logo, Apache Hive™, Hive, and the Hive logo,
        Apache Spark™, Spark, and the Spark logo, Apache Airflow, Airflow, and the Airflow logo,
        Apache HBase®, HBase, and the HBase logo, Apache NiFi, NiFi, and the NiFi logo, Apache
        Superset, Superset, the Superset logo, Apache Hadoop® HDFS, Apache Hadoop, Hadoop and the
        Hadoop logo, Apache Phoenix™, Phoenix and the Phoenix-Logo, Apache Iceberg, Iceberg and the
        Iceberg-Logo are either registered trademarks or trademarks of the Apache Software Foundation
        in the United States and/or other countries. Open Policy Agent (OPA) is a Cloud Native
        Computing Foundation graduated project. Licensed under the Apache License, Version 2.0. Trino
        is open source software licensed under the Apache License 2.0 and supported by the Trino
        Software Foundation. MinIO is a [“registered”, if applicable] trademark of the MinIO
        Corporation. All other products or name brands are trademarks of their respective holders.
        All product and service names used in this website are for identification purposes only and
        do not imply endorsement.
      </p>
    </div>
  </div>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script src="../../_/js/vendor/lunr.js"></script>
<script src="../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../.." data-snippet-length="100" data-stylesheet="../../_/css/search.css"></script>
<script async src="../../search-index.js"></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Configuration :: Stackable Documentation</title>
    <meta name="generator" content="Antora 3.0.1">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
    <link rel="icon" href="../../_/img/favicon.png" type="image/png">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://stackable.de"><img src="../../_/img/stackable-logo.png"></a>
      <a class="navbar-item documentation-link" href="https://docs.stackable.tech">Documentation</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="navbar-sub">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <a href="https://www.stackable.de/en/contact/" class="button pull-right">Contact Us</a>
    </div>
      <div id="topbar-nav" class="navbar-menu">
      </div>
      </div>
    </nav>
    <nav id="navbar-sub" class="navbar-sub">
      <div class="container">
        <a class="navbar-sub-item" href="../../home/index.html">Home</a>
<a class="navbar-sub-item" href="../../home/getting_started.html">Getting Started</a>
<a class="navbar-sub-item" href="../../home/tutorials/end-to-end_data_pipeline_example.html">Tutorials</a>
<div class="navbar-sub-item drop-down">
    Operators
    <div class="drop-down-content">
    <a class="drop-down-item" href="../../home/operators/index.html">Overview</a>
    <a class="drop-down-item" href="../../airflow/index.html">Apache Airflow</a>
    <a class="drop-down-item" href="../../druid/index.html">Apache Druid</a>
    <a class="drop-down-item" href="../../hbase/index.html">Apache HBase</a>
    <a class="drop-down-item" href="../../hdfs/index.html">Apache Hadoop HDFS</a>
    <a class="drop-down-item" href="../../hive/index.html">Apache Hive</a>
    <a class="drop-down-item" href="../../kafka/index.html">Apache Kafka</a>
    <a class="drop-down-item" href="../index.html">Apache NiFi</a>
    <a class="drop-down-item" href="../../spark/index.html">Apache Spark (standalone)</a>
    <a class="drop-down-item" href="../../spark-k8s/index.html">Apache Spark on K8S</a>
    <a class="drop-down-item" href="../../superset/index.html">Apache Superset</a>
    <a class="drop-down-item" href="../../trino/index.html">Trino</a>
    <a class="drop-down-item" href="../../zookeeper/index.html">Apache ZooKeeper</a>
    <a class="drop-down-item" href="../../opa/index.html">OpenPolicyAgent</a>
    <a class="drop-down-item" href="../../commons-operator/index.html">Commons</a>
    <a class="drop-down-item" href="../../secret-operator/index.html">Secret</a>
    </div>
</div>
<a class="navbar-sub-item" href="../../home/contributor/index.html">Contribute</a>

        <a class="arrow" href="javascript:document.querySelector('.navbar-sub').classList.toggle('open')">
          <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="arrow-right" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"></path></svg>
        </a>
      </div>
    </nav>
  </header>
<div class="body">
    <div class="container">
<div class="nav-container" data-component="nifi" data-version="nightly">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Stackable Operator for Apache NiFi</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dependencies.html">Dependencies</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="installation.html">Installation</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="configuration.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="usage.html">Usage</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Stackable Operator for Apache NiFi</span>
    <span class="version">nightly</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../commons-operator/0.1/index.html">Stackable Commons Operator</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../commons-operator/0.1/index.html">0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../home/index.html">Stackable Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../home/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../airflow/nightly/index.html">Stackable Operator for Apache Airflow</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../airflow/nightly/index.html">nightly</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../druid/nightly/index.html">Stackable Operator for Apache Druid</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../druid/nightly/index.html">nightly</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../hbase/nightly/index.html">Stackable Operator for Apache HBase</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../hbase/nightly/index.html">nightly</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../hdfs/nightly/index.html">Stackable Operator for Apache HDFS</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../hdfs/nightly/index.html">nightly</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../hive/nightly/index.html">Stackable Operator for Apache Hive</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../hive/nightly/index.html">nightly</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../kafka/nightly/index.html">Stackable Operator for Apache Kafka</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../kafka/nightly/index.html">nightly</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="index.html">Stackable Operator for Apache NiFi</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">nightly</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../spark/nightly/index.html">Stackable Operator for Apache Spark</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../spark/nightly/index.html">nightly</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../spark-k8s/index.html">Stackable Operator for Apache Spark on Kubernetes</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../spark-k8s/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../superset/nightly/index.html">Stackable Operator for Apache Superset</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../superset/nightly/index.html">nightly</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../zookeeper/nightly/index.html">Stackable Operator for Apache ZooKeeper</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../zookeeper/nightly/index.html">nightly</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../opa/nightly/index.html">Stackable Operator for OPA</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../opa/nightly/index.html">nightly</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../trino/nightly/index.html">Stackable Operator for Trino</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../trino/nightly/index.html">nightly</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../secret-operator/nightly/index.html">Stackable Secret Operator</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../secret-operator/nightly/index.html">nightly</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../home/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Stackable Operator for Apache NiFi</a></li>
    <li><a href="configuration.html">Configuration</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/stackabletech/nifi-operator/edit/main/docs/modules/ROOT/pages/configuration.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Configuration</h1>
<div class="sect1">
<h2 id="_command_line_parameters"><a class="anchor" href="#_command_line_parameters"></a>Command Line Parameters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This operator accepts the following command line parameters:</p>
</div>
<div class="sect2">
<h3 id="_product_config"><a class="anchor" href="#_product_config"></a>product-config</h3>
<div class="paragraph">
<p><strong>Default value</strong>: <code>/etc/stackable/nifi-operator/config-spec/properties.yaml</code></p>
</div>
<div class="paragraph">
<p><strong>Required</strong>: false</p>
</div>
<div class="paragraph">
<p><strong>Multiple values:</strong> false</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">stackable-nifi-operator run --product-config /foo/bar/properties.yaml</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_watch_namespace"><a class="anchor" href="#_watch_namespace"></a>watch-namespace</h3>
<div class="paragraph">
<p><strong>Default value</strong>: All namespaces</p>
</div>
<div class="paragraph">
<p><strong>Required</strong>: false</p>
</div>
<div class="paragraph">
<p><strong>Multiple values:</strong> false</p>
</div>
<div class="paragraph">
<p>The operator will <strong>only</strong> watch for resources in the provided namespace <code>test</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">stackable-nifi-operator run --watch-namespace test</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_environment_variables"><a class="anchor" href="#_environment_variables"></a>Environment variables</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This operator accepts the following environment variables:</p>
</div>
<div class="sect2">
<h3 id="_product_config_2"><a class="anchor" href="#_product_config_2"></a>PRODUCT_CONFIG</h3>
<div class="paragraph">
<p><strong>Default value</strong>: <code>/etc/stackable/nifi-operator/config-spec/properties.yaml</code></p>
</div>
<div class="paragraph">
<p><strong>Required</strong>: false</p>
</div>
<div class="paragraph">
<p><strong>Multiple values:</strong> false</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">export PRODUCT_CONFIG=/foo/bar/properties.yaml
stackable-nifi-operator run</code></pre>
</div>
</div>
<div class="paragraph">
<p>or via docker:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>docker run \
    --name nifi-operator \
    --network host \
    --env KUBECONFIG=/home/stackable/.kube/config \
    --env PRODUCT_CONFIG=/my/product/config.yaml \
    --mount type=bind,source="$HOME/.kube/config",target="/home/stackable/.kube/config" \
    docker.stackable.tech/stackable/nifi-operator:latest</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_watch_namespace_2"><a class="anchor" href="#_watch_namespace_2"></a>WATCH_NAMESPACE</h3>
<div class="paragraph">
<p><strong>Default value</strong>: All namespaces</p>
</div>
<div class="paragraph">
<p><strong>Required</strong>: false</p>
</div>
<div class="paragraph">
<p><strong>Multiple values:</strong> false</p>
</div>
<div class="paragraph">
<p>The operator will <strong>only</strong> watch for resources in the provided namespace <code>test</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">export WATCH_NAMESPACE=test
stackable-nifi-operator run</code></pre>
</div>
</div>
<div class="paragraph">
<p>or via docker:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">docker run \
--name nifi-operator \
--network host \
--env KUBECONFIG=/home/stackable/.kube/config \
--env WATCH_NAMESPACE=test \
--mount type=bind,source="$HOME/.kube/config",target="/home/stackable/.kube/config" \
docker.stackable.tech/stackable/nifi-operator:latest</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_kubernetes_custom_resource_options"><a class="anchor" href="#_kubernetes_custom_resource_options"></a>Kubernetes custom resource options</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The cluster can be configured via a YAML file. This custom resource specifies the amount of replicas for each role group or role specific configuration like port definitions etc.
The following listing shows a fairly complete example that sets most available options, for more detail about the individual elements please refer to the table further down on the page.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: nifi.stackable.tech/v1alpha1
kind: NifiCluster
metadata:
  name: simple-nifi
spec:
  version: "1.15.0"
  zookeeperConfigMapName: simple-nifi-znode
  authenticationConfig:
    method:
      SingleUser:
        adminCredentialsSecret:
          name: nifi-admin-credentials-simple
          namespace: default
    allowAnonymousAccess: true
  nodes:
    roleGroups:
      default:
        selector:
          matchLabels:
            kubernetes.io/os: linux
        config:
          sensitivePropertyKeySecret: nifi-sensitive-property-key
          log:
            rootLogLevel: INFO
        replicas: 3</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_node_configuration"><a class="anchor" href="#_node_configuration"></a>Node Configuration</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml"> nodes:
    roleGroups:
      default:
        selector:
          matchLabels:
            kubernetes.io/os: linux
        config:
        replicas: 3</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>nodes</code> element is used to define how many pods with which configuration should be rolled out.
It is possible to define multiple groups of nodes, each with its own distinct configuration, every <code>roleGroup</code> has the following elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>selector: a Kubernetes <code>Selector</code> to specify criteria that can be used to target nodes</p>
</li>
<li>
<p>config: The NiFi config to use for this group</p>
</li>
<li>
<p>replicas: How many pods to roll out for this group</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_authentication"><a class="anchor" href="#_authentication"></a>Authentication</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">  authenticationConfig:
    method:
      SingleUser:
        adminCredentialsSecret:
          name: nifi-admin-credentials-simple
          namespace: default
    allowAnonymousAccess: true</code></pre>
</div>
</div>
<div class="paragraph">
<p>All authentication related parameters are configured in the authenticationConfig element.</p>
</div>
<div class="sect3">
<h4 id="_authentication_method"><a class="anchor" href="#_authentication_method"></a>Authentication Method</h4>
<div class="paragraph">
<p>Currently, the only supported authentication method is "SingleUser", which allows the definition of one admin user which can then access the cluster.
Specification of these users credentials happens via referring to a Secret in Kubernetes, this secret will need to contain at least the two keys <code>username</code> and <code>password</code>.
Extra keys may be present, but will be ignored by the operator.</p>
</div>
</div>
<div class="sect3">
<h4 id="_anonymous_access"><a class="anchor" href="#_anonymous_access"></a>Anonymous Access</h4>
<div class="paragraph">
<p>NiFi can be configured to allow anonymous access to the web UI, this is turned off by default, but can be enabled via the parameter <code>allowAnonymousAccess</code>.
This setting is independent of the configured authentication method and will override anything specified for the authentication provider.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_zookeeper_connection"><a class="anchor" href="#_zookeeper_connection"></a>ZooKeeper Connection</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">  zookeeperConfigMapName: simple-nifi-znode</code></pre>
</div>
</div>
<div class="paragraph">
<p>NiFi in cluster mode requires a ZooKeeper ensemble for state management and leader election purposes, this operator at the moment does not support single node deployments without ZooKeeper, hence this is a required setting.
Configuration happens via a ConfigMap, which needs to contain two keys called <code>ZOOKEEPER_HOSTS</code> with the value being the ZooKeeper connection string and <code>ZOOKEEPER_CHROOT</code> with the value being the ZooKeeper chroot. This ConfigMap typically is created by a ZookeeperZnode of the <a href="https://github.com/stackabletech/zookeeper-operator">ZooKeeper Operator</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_nifi_configuration"><a class="anchor" href="#_nifi_configuration"></a>NiFi Configuration</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">config:
  sensitivePropertyKeySecret: nifi-sensitive-property-key
  log:
    rootLogLevel: INFO</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is the actual NiFi configuration element.
At the moment only a very limited set of options is supported, but you can expect these to grow quickly over time.
Anything that is not mentioned here can be configured via configOverrides. This does not include properties for XML files like <code>state-management.xml</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_overrides"><a class="anchor" href="#_configuration_overrides"></a>Configuration Overrides</h3>
<div class="paragraph">
<p>Apache NiFi runtime configuration is stored in a file named nifi.properties.
The configOverrides block allows you to add custom parameters to this file.
A Full list of the available configuration options can be found in the official Apache NiFi documentation at <a href="https://nifi.apache.org/docs/nifi-docs/components/nifi-docs/html/administration-guide.html#system_properties" class="bare">https://nifi.apache.org/docs/nifi-docs/components/nifi-docs/html/administration-guide.html#system_properties</a>.</p>
</div>
<div class="paragraph">
<p>Overrides consist of a key, which must match the property name in the configuration file and a value. This allows arbitrary configuration properties to be added to Spark. In the example above a property aws.region is being explicitly set to 'eu-west-1', overriding the default value.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Please be aware that by overriding config settings in this section you have a very high risk of breaking things, because the product does not behave the way the Stackable Operator for Apache NiFi expects it to behave any more.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following snippet shows an example of how this would look in the NifiCluster definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">        config:
          sensitivePropertyKeySecret: nifi-sensitive-property-
        configOverrides:
          nifi.properties:
            aws.region: eu-west-1
        replicas: 2</code></pre>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
    </div>
</div>
<footer class="footer">
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script src="../../_/js/vendor/lunr.js"></script>
<script src="../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../.." data-snippet-length="100" data-stylesheet="../../_/css/search.css"></script>
<script async src="../../search-index.js"></script>
  </body>
</html>

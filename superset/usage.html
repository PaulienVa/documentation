<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Usage :: Stackable Documentation</title>
    <link rel="canonical" href="https://docs.stackable.tech/superset/usage.html">
    <meta name="generator" content="Antora 3.0.1">
    <link rel="stylesheet" href="../_/css/site.css">
    <script>var uiRootPath = '../_'</script>
    <link rel="icon" href="../_/img/favicon.png" type="image/png">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://stackable.de"><img src="../_/img/stackable-logo.png"></a>
      <a class="navbar-item documentation-link" href="https://docs.stackable.tech">Documentation</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <a href="https://www.stackable.de/en/contact/" class="button pull-right">Contact Us</a>
    </div>
      <div id="topbar-nav" class="navbar-menu">
      </div>
      </div>
    </nav>
    <nav class="navbar-sub">
      <div class="container">
        <a class="navbar-sub-item" href="../home/index.html">Overview</a>
<a class="navbar-sub-item" href="../home/index.html">Architecture</a>
<a class="navbar-sub-item" href="../home/getting_started.html">Getting Started</a>
<div class="navbar-sub-item drop-down">
    Operators
    <div class="drop-down-content">
    <a class="drop-down-item" href="../airflow/index.html">Apache Airflow</a>
    <a class="drop-down-item" href="../druid/index.html">Apache Druid</a>
    <a class="drop-down-item" href="../hbase/index.html">Apache HBase</a>
    <a class="drop-down-item" href="../hdfs/index.html">Apache Hadoop HDFS</a>
    <a class="drop-down-item" href="../hive/index.html">Apache Hive</a>
    <a class="drop-down-item" href="../kafka/index.html">Apache Kafka</a>
    <a class="drop-down-item" href="../nifi/index.html">Apache NiFi</a>
    <a class="drop-down-item" href="../spark/index.html">Apache Spark</a>
    <a class="drop-down-item" href="index.html">Apache Superset</a>
    <a class="drop-down-item" href="../trino/index.html">Trino</a>
    <a class="drop-down-item" href="../zookeeper/index.html">Apache ZooKeeper</a>
    <a class="drop-down-item" href="../opa/index.html">OpenPolicyAgent</a>
    <a class="drop-down-item" href="../secret-operator/index.html">Secret</a>
    </div>
</div>

        <a class="arrow" href="javascript:document.querySelector('.navbar-sub').classList.toggle('open')">
          <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="arrow-right" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"></path></svg>
        </a>
      </div>
    </nav>
  </header>
<div class="body">
    <div class="container">
<div class="nav-container" data-component="superset" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Stackable Operator for Apache Superset</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="installation.html">Installation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="configuration.html">Configuration</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="usage.html">Usage</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Stackable Operator for Apache Superset</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../commons-operator/index.html">Stackable Commons Operator</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../commons-operator/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../home/index.html">Stackable Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../home/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../airflow/index.html">Stackable Operator for Apache Airflow</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../airflow/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../druid/index.html">Stackable Operator for Apache Druid</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../druid/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../hbase/index.html">Stackable Operator for Apache HBase</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../hbase/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../hdfs/index.html">Stackable Operator for Apache HDFS</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../hdfs/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../hive/index.html">Stackable Operator for Apache Hive</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../hive/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../kafka/index.html">Stackable Operator for Apache Kafka</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../kafka/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../nifi/index.html">Stackable Operator for Apache NiFi</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../nifi/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../spark/index.html">Stackable Operator for Apache Spark</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../spark/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="index.html">Stackable Operator for Apache Superset</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../zookeeper/index.html">Stackable Operator for Apache ZooKeeper</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../zookeeper/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../opa/index.html">Stackable Operator for OPA</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../opa/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../trino/index.html">Stackable Operator for Trino</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../trino/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../secret-operator/index.html">Stackable Secret Operator</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../secret-operator/index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../home/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Stackable Operator for Apache Superset</a></li>
    <li><a href="usage.html">Usage</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/stackabletech/superset-operator/edit/main/docs/modules/ROOT/pages/usage.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Usage</h1>
<div class="sect1">
<h2 id="_database_for_the_superset_metadata"><a class="anchor" href="#_database_for_the_superset_metadata"></a>Database for the Superset metadata</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The metadata of Superset (slices, connections, tables, dashboards, &#8230;&#8203;) is stored in an SQL
database.</p>
</div>
<div class="paragraph">
<p>For testing purposes, you can spin up a PostgreSQL database with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">helm repo add bitnami https://charts.bitnami.com/bitnami

helm install superset bitnami/postgresql \
    --set auth.username=superset \
    --set auth.password=superset \
    --set auth.database=superset</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_secret_with_superset_credentials"><a class="anchor" href="#_secret_with_superset_credentials"></a>Secret with Superset credentials</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A secret with the necessary credentials must be created, this entails database connection credentials as well as an admin account for superset itself:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
kind: Secret
metadata:
  name: simple-superset-credentials
type: Opaque
stringData:
  adminUser.username: admin
  adminUser.firstname: Superset
  adminUser.lastname: Admin
  adminUser.email: admin@superset.com
  adminUser.password: admin
  connections.secretKey: thisISaSECRET_1234
  connections.sqlalchemyDatabaseUri: postgresql://superset:superset@superset-postgresql.default.svc.cluster.local/superset</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>connections.secretKey</code> will be used for securely signing the session cookies and can be used
for any other security related needs by extensions. It should be a long random string of bytes.</p>
</div>
<div class="paragraph">
<p><code>connections.sqlalchemyDatabaseUri</code> must contain the connection string to the SQL database storing
the Superset metadata.</p>
</div>
<div class="paragraph">
<p>The <code>adminUser</code> fields are used to create an admin user.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creation_of_a_superset_node"><a class="anchor" href="#_creation_of_a_superset_node"></a>Creation of a Superset node</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A Superset node must be created as a custom resource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: superset.stackable.tech/v1alpha1
kind: SupersetCluster
metadata:
  name: superset
spec:
  version: 1.4.1
  statsdExporterVersion: v0.22.4
  credentialsSecret: simple-superset-credentials
  loadExamplesOnInit: true
  nodes:
    roleGroups:
      default:
        config:</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>metadata.name</code> contains the name of the Superset cluster.</p>
</div>
<div class="paragraph">
<p>The label of the Docker image provided by Stackable must be set in <code>spec.version</code>.</p>
</div>
<div class="paragraph">
<p><code>spec.statsdExporterVersion</code> must contain the tag of a statsd-exporter Docker image in the Stackable repository.</p>
</div>
<div class="paragraph">
<p>The previously created secret must be referenced in <code>spec.credentialsSecret</code>.</p>
</div>
<div class="paragraph">
<p>The <code>spec.loadExamplesOnInit</code> key is optional and defaults to <code>false</code>, it can be set to <code>true</code> to load example data into superset when the database is initialized.</p>
</div>
<div class="sect2">
<h3 id="_initialization_of_the_superset_database"><a class="anchor" href="#_initialization_of_the_superset_database"></a>Initialization of the Superset database</h3>
<div class="paragraph">
<p>The first time the cluster is created, the operator creates a <code>SupersetDB</code> resource with the same name as the cluster.  It ensures that the database is initialized (schema created, admin user created).</p>
</div>
<div class="paragraph">
<p>A Kubernetes job is created which starts a pod to initialize the database. This can take a while.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_superset"><a class="anchor" href="#_using_superset"></a>Using Superset</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When the Superset node is created and the database is initialized, Superset can be opened in the
browser.</p>
</div>
<div class="paragraph">
<p>The Superset port which defaults to <code>8088</code> can be forwarded to the local host:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl port-forward service/simple-superset-external 8088</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then it can be opened in the browser with <code><a href="http://localhost:8088" class="bare">http://localhost:8088</a></code>.</p>
</div>
<div class="paragraph">
<p>Enter the admin credentials from the Kubernetes secret:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/superset-login.png" alt="Login screen of Superset">
</div>
</div>
<div class="paragraph">
<p>If the examples were loaded then some dashboards are already available:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/superset-dashboard.png" alt="Superset dashboard showing birth names">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_connecting_apache_druid_clusters"><a class="anchor" href="#_connecting_apache_druid_clusters"></a>Connecting Apache Druid Clusters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The operator can automatically connect superset clusters to Apache Druid clusters managed by the <a href="https://docs.stackable.tech/druid/index.html">Stackable Druid Cluster</a>.</p>
</div>
<div class="paragraph">
<p>To do so, create a <code>DruidConnection</code> resource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: superset.stackable.tech/v1alpha1
kind: DruidConnection
metadata:
  name: superset-druid-connection
spec:
  superset:
    name: superset
    namespace: default
  druid:
    name: my-druid-cluster
    namespace: default</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>name</code> and <code>namespace</code> in <code>spec.superset</code> refer to the superset cluster that you want to connect. Following our example above, the name is <code>superset</code>.</p>
</div>
<div class="paragraph">
<p>In <code>spec.druid</code> you specify the <code>name</code> and <code>namespace</code> of your Druid cluster.</p>
</div>
<div class="paragraph">
<p>Once the database is initialized, the connection will be added to the cluster by the operator. You can see it in the user interface under Data &gt; Databases:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/superset-databases.png" alt="Superset databases showing the connected Druid cluster">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_monitoring"><a class="anchor" href="#_monitoring"></a>Monitoring</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The managed Superset instances are automatically configured to export Prometheus metrics. See
<a href="../home/monitoring.html" class="xref page">Monitoring</a> for more details.</p>
</div>
</div>
</div>
</article>
  </div>
</main>
    </div>
</div>
<footer class="footer">
</footer>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
<script src="../_/js/vendor/lunr.js"></script>
<script src="../_/js/search-ui.js" id="search-ui-script" data-site-root-path=".." data-snippet-length="100" data-stylesheet="../_/css/search.css"></script>
<script async src="../search-index.js"></script>
  </body>
</html>

= ADR028: Platform release support policy
Sebastian <sebastian.bernauer@stackable.tech>
v0.1, 2023-05-08
:status: draft

* Status: {status}
* Contributors:
** Andrew Kenworthy
** Felix Hennig
** Lars Francke
** Maximilian Wittich
** Malte Sander
** Natalie Klestrup Röijezon
** Razvan Mihai
** Sebastian Bernauer
** Sönke Liebau
** Vladislav Supalov
* Date: 2023-05-08

== Context and Problem Statement

// Describe the context and problem statement, e.g., in free form using two to three sentences. You may want to articulate the problem in form of a question.

Users of the Stackable platform often times want to stay on a specific product version - sometime also platform version.
While staying on a specific set of versions would theoretically work, the customers often want security updates, hence the reason we need to maintain older versions - for operators as well as product versions.

We currently don't have CRD versioning yet, this will be added in the future.

Currently we do support the last 3 Kubernetes versions.

== Decision Drivers

* Customer requirements for stability, but also security updates
* Maintenance/support effort

== Considered Options



=== No LTS versions
We don't have any LTS release.
Instead we support the last *X* (e.g. 2) releases, so users have approx. *X* (e.g. 6) months of time to upgrade the operators.

==== Pros
* No maintenance effort

==== Cons
* For many customers the time period is too short

=== Time-based LTS versions
We mark specific Stackable platform releases (e.g. the first within a year) as LTS releases.
We do support them for *X* (e.g. 12) months.

==== Pros
* There is a guarantee for users how long their stuff will be supported

==== Cons
* Maintenance/support effort



=== LTS CRD versions
In the future every CustomResource of Stackable will be versioned.
We will make guarantees regarding how long a specific version of the CustomResources will be supported.

We set ourselves the following constraints:

1. Alpha API versions may be removed in any release without prior deprecation notice.
2. Beta API versions are deprecated at a minimum of *1* platform releases after introduction and removed at a minimum of *1* platform releases after deprecation.
3. GA (stable) API versions are deprecated at a minimum of *2* platform releases after introduction and removed at a minimum of *1* platform releases after deprecation.

In addition to the CRD versions we support the operators of the last *2* Stackable platform release lines (e.g. `23.4.x`).

In addition customers can pay money to extend the support of a specific API version.
This can be either the case when the version is currently officially supported, in which case it can continue to be supported.
Or it can be in case the version is already deprecated, in which case it will stay deprecated until removal.

Image the following CRD version timeline:

image::adr/28-crd-versions.png[]

For the give timeline every release notes for a Stackable platform release contains something similar to the following:

*Release 23.7*

Added CRD versions:

* ZookeeperCluster v1alpha2
* ZookeeperCluster v1beta2
* ZookeeperCluster v1

*Release 23.10*

Removed CRD versions:

* ZookeeperCluster v1alpha2

Deprecated CRD versions:

* ZookeeperCluster v1beta2

*Release 24.1*

Added CRD versions:

* ZookeeperCluster v2
* ZookeeperCluster v3

Removed CRD versions:

* ZookeeperCluster v1beta2

Deprecated CRD versions:

* ZookeeperCluster v1

*Release 24.7*

Removed CRD versions:

* ZookeeperCluster v1

Open questions: How do we handle support questions for deprecated versions?


==== Pros
* This mechanism gives us the possibility to try out experimental features in an alpha version to get feedback. Afterwards we can add it as beta or stable feature.

==== Cons
* Customers can't switch to newer operators if they have an really old Kubernetes version.
As we have a similar Kubernetes support cycle than the Kubernetes project itself chances are pretty high they are running on an EOL Kubernetes version already.

== Decision Outcome

Option <<LTS CRD versions>> was chosen.
